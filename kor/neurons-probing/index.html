<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
    
<head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bumjini | 뉴런 - 3. 뉴런을 해석하는 뉴런</title>
    <meta name="author" content="Bumjini  " />
    <meta name="description" content="딥러닝 모델의 뉴런을 해석하는 방식은 여러가지가 있지만, Probing은 뉴런의 아웃풋을 기반으로 특징을 추론할 수 있다면 특징을 가지는 뉴런으로 인식하는 방법이다." />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🪴</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://fxnnxc.github.io/kor/neurons-probing/">
    
    <!-- Dark Mode -->
    

  <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams',
        inlineMath: [['$','$'], ['\\(','\\)']]
      },
      chtml: {
          scale: 1.0,
          minScale: .6,  
          mtextFontInherit: true,
          mtextInheritFont: true,
          merrorInheritFont: true,
        },
        svg: {
          scale: 1.2
        }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  <!-- Distill js -->
  <script src="/assets/js/distillpub/template.v2.js"></script>
  <script src="/assets/js/distillpub/transforms.v2.js"></script>
  <script src="/assets/js/distillpub/overrides.js"></script>
  <!-- Page/Post style -->
  
</head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "뉴런 - 3. 뉴런을 해석하는 뉴런",
      "description": "딥러닝 모델의 뉴런을 해석하는 방식은 여러가지가 있지만, Probing은 뉴런의 아웃풋을 기반으로 특징을 추론할 수 있다면 특징을 가지는 뉴런으로 인식하는 방법이다.",
      "published": "July 28, 2023",
      "authors": [
        {
          "author": "Bumjin Park",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body style="padding-top:0px" class="sticky-bottom-footer"> 
    
    <!-- Header --><header>
      
      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm sticky-top">
        <div class="container">
          <img>
          <!-- <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;"> -->
          
          <a class="navbar-brand title font-weight-lighter" href="https://fxnnxc.github.io/" style="margin-left:20px ;">
              <!--Bumjini-->
           <span class="font-weight-bold" style="font-size:larger;font-family:Times New Roman;">Bumjini    </span>
        </a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <!-- <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/">  About Me</a>
              </li> -->
              
              <!-- Blog -->
              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_papers/"> Papers</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_articles/"> Articles</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_projects/"> Projects</a>
              </li>

              <!-- Other pages -->
              <li style="font-size: 17px" class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Others</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/side_papers/">🗂️ side-paper</a>
                  <a class="dropdown-item" href="/side_articles/">🥕 side-articles</a>
                  <a class="dropdown-item" href="/book/">📚 book (korean)</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1 style="font-size: 32px;">뉴런 - 3. 뉴런을 해석하는 뉴런</h1>
        <p>딥러닝 모델의 뉴런을 해석하는 방식은 여러가지가 있지만, Probing은 뉴런의 아웃풋을 기반으로 특징을 추론할 수 있다면 특징을 가지는 뉴런으로 인식하는 방법이다.</p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        

        <h1 id="소개">소개</h1>

<p>딥러닝 모델의 내부에는 수많은 뉴런들이 존재하며, 특정한 패턴에 의해서 뉴런은 강하게 활성화 된다. 
특징에 대해서 강하게 반응하는 뉴런의 존재성은 우리가 쉽게 추측할 수 있다. 그러나, 수많은 뉴런 중에서 어떤 뉴런이 내가 생각하는 패턴에 반응하는지 찾는 것은 쉽지 않은 일이다.
쉽지않은 이유는 뉴런의 활성화 정도를 기반으로 특징을 가지고 있다고 판단학는 것은 휴리스틱하다. 바꿔말하면, 우리는 특정 패턴에 대해서 뉴런이 얼마나 활성화되어야 해당 패턴을 지니고 있는 뉴런이라고 확정할 수 있는지 알 수 없다. 
다음과 같은 약점을 생각해보자.</p>

<ul>
  <li>얼룩말의 줄무늬에 대해서 반응하는 뉴런은 모델 내부에 셀 수 없이 많이 있다. <br> (Multiple Neurons are activated by a single image)</li>
  <li>얼룩말의 줄무늬에 대해서 하나의 뉴런이 몇 번 반응해야 하는지 알 수 없다. <br> (How much <code class="language-plaintext highlighter-rouge">#Activated Samples</code> / <code class="language-plaintext highlighter-rouge">#Total Samples</code>? )</li>
  <li>얼룩말의 줄무늬에 대해서 얼마나 반응해야 하는지 알 수 없다. <br> (What is the proper threshold for activation)</li>
</ul>

<p>딥러닝의 뉴런이 특징을 가지고 있는지 확인하기 위해서는 휴리스틱하게 찾기보다  입력 패턴과 뉴런의 출력에 대한 상관관계가 학습가능한지 여부로 생각할 수 있다.
여기서 생각하는 가정은 다음과 같다.</p>

<blockquote>
  <p>뉴런의 활성화 정도로 패턴의 유무를 추정할 수 있는가?</p>
</blockquote>

<p>뉴런의 활성화 정도로 특징의 유무를 찾기 위해서는 두 종류의 뉴런이 필요하다. <br> 바로 입력에 반응하는 뉴런($x \mapsto h $)과 뉴런의 반응을 해석하는 뉴런($h \mapsto c $)이다.</p>

<h2 id="입력에-반응하는-뉴런">입력에 반응하는 뉴런</h2>

<p>입력에 반응하는 뉴런은 입력 $x$ 에 대해서 주어진 특징이 존재하는 경우 반응하는 뉴런이다. 
주어진 특징의 정도가 강하다면 뉴런은 강하게 반응하고, 특징이 존재하지 않는다면 반응하지 말아야 한다. 
연산적으로 입력에 반응하는 뉴런은 활성화값 $h$를 내보내며 입력 정보는 컨셉을 지니고 있을수도, 없을수도 있다.</p>

<blockquote>
  <p>수식: 입력에 반응하는 뉴런</p>
  <ul>
    <li>$f_{n}$ : 딥러닝 모델 $f$ 에 존재하는 $n$ 번째 뉴런.</li>
    <li>$x$ : 컨셉을 가지거나, 가지지 못한 입력</li>
    <li>$c(x)$ : $x$ 가 가지고 있는 컨셉의 유무나 수치적 정도, 혹은 컨셉에 대한 레이블</li>
    <li>$h = f_{n}(x)$ : 입력 $x$ 로부터 $f_{n}$ 이 내보내는 활성화 정도</li>
  </ul>
</blockquote>

<hr>

<h2 id="뉴런을-해석하는-뉴런">뉴런을 해석하는 뉴런</h2>

<p>뉴런의 활성화에 반응하는 뉴런은 $h$을 입력으로 받아서 컨셉 $c$의 존재 여부를 예측한다. 
만일 $h$를 입력으로 특징 $c$ 를 높은 확률로 예측할 수 있다면 그리고 뉴런이 활성화될 때 입력에 컨셉이 존재했다면, 해당 뉴런은 해당 컨셉을 지니고 있다고 판단할 수 있다 <d-footnote> 입력이 활성화되지 않았을 경우에, 역으로 주어진 특징이 존재했을 가능성도 있을지는 의문이다.</d-footnote>. 따라서 뉴런에 반응하는 뉴런을 만들기 위해서는 학습이 필연적이며, 학습데이터와 테스트데이터를 구분해서 일반화가 되는지 확인해야 한다.</p>

<h3 id="선형적으로-해석하는-뉴런">선형적으로 해석하는 뉴런</h3>

<p>뉴런을 해석하는 뉴런의 가장 간단한 형태는 선형모델로 다음과 같이 적을 수 있다.</p>

\[f_n = \sigma(wh) ,  ~~~~ \text{ where }   {w},{h} \in \mathbb{R}\]

<p>이 경우 단 하나의 weight $w$ 가 뉴런이며, 입력값으로 h를 받는다. $sigma$는 Sigmoid 함수로 0과 1사이의 값으로 맵핑함으로써, 0.5를 기준으로 존재의 유무를 파악할 수 있다.</p>

<ul>
  <li>💡 만일 특징이 존재한다면, weight 는 큰 양수로 학습이 될 것이다.</li>
  <li>💡 만일 특징이 존재하지 않는다면, weight 은 0에 가깝게 학습이 될 것이다.</li>
</ul>

<h3 id="선형적으로-많은-뉴런을-동시에-해석하는-뉴런">선형적으로 많은 뉴런을 동시에 해석하는 뉴런</h3>

<p>위에서 가정한 것은 하나의 뉴런에 대해서 값의 여부를 파악하는 것이었다. 그러나 우리는 굳이 한 뉴런에 대해서만 값을 해석할 필요는 없다. 
다양한 뉴런들을 동시에 연결하여 해석이 가능한지 학습하는 것이다. 이 경우 해석하는 뉴런은 여러 개의 뉴런들로부터 값을 종합하여 해석을 내리게 되며, 
많일 양의 상관관계가 존재하는 뉴런이 있다면 해당 뉴런과의 연결(시냅스)는 강한 양수로 학습될 것이다.</p>

\[f_n =  \sigma( \mathbf{w} \cdot \mathbf{h}),  ~~~~ \text{ where }   \mathbf{w},\mathbf{h} \in \mathbb{R}^d\]

<p>한가지 재밌는 사실은 해당 뉴런은 하나의 특징에 대한 레이블을 학습하도록 반응하는 것이다. 그러나 뉴런들은 동일한 층에서 서로 독립적으로 정보처리를 하므로, 다음과 같은 형태로 $N$ 개의 특징의 유무를 동시에 학습할 수 있다.</p>

\[f_{1,\cdots, N} =  \sigma( W \cdot \mathbf{h}),  ~~~~ \text{ where }   \mathbf{w} \in \mathbb{R}^{N\times d} ,\mathbf{h} \in \mathbb{R}^d\]

<h3 id="비선형적인-해석">비선형적인 해석</h3>

<p>위에서 여러 개의 뉴런들의 정보를 종합하여 주어진 특징을 가지 뉴런을 선형적으로 찾을 수 있다고 하였다. 그러나 개별 뉴런의 해석으로는 값이 없지만,  만일 뉴런들의 아웃풋들간의 관계로 인해서 특징을 발견할 수도 있다.  이 경우 일반화된 함수 $g$ 로부터 특징을 구분하도록 학습하면 된다.</p>

\[f_n =  g(\mathbf{h}),  ~~~~ \text{ where }   \mathbf{w},\mathbf{h} \in \mathbb{R}^d, f_n :  \mathbb{R}^d \rightarrow \mathbb{R}\]

<p>위에서 선형적으로 해석하는 뉴런들을 동시에 학습할 수 있다고 하였는데, 비선형에서는 뉴런의 정보처리가 서로 독립적이지 않게 학습되므로 개별적으로 학습해야 한다.</p>

<hr>

      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

<!--<div id="disqus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script type="text/javascript">
        var disqus_shortname  = 'al-folio';
        var disqus_identifier = '/kor/neurons-probing';
        var disqus_title      = "뉴런 - 3. 뉴런을 해석하는 뉴런";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </div>
 -->
      <hr>
<div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script>
      let giscusTheme = localStorage.getItem("theme");
      let giscusAttributes = {
          "src": "https://giscus.app/client.js",
          "data-repo": "fxnnxc/fxnnxc",
          "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMjQ2NjUxMTU=",
          "data-category": "Q&A",
          "data-category-id": "DIC_kwDOE1n_G84CYOk_",
          "data-mapping": "title",
          "data-strict": "0",
          "data-reactions-enabled": "1",
          "data-emit-metadata": "0",
          "data-input-position": "top",
          "data-theme": giscusTheme,
          "data-lang": "en",
          "crossorigin": "anonymous",
          "async": "",
      };
  
  
      let giscusScript = document.createElement("script");
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById("giscus_thread").appendChild(giscusScript);
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by giscus.</a>
</noscript>
  </div>
<!-- Footer -->    <footer class="sticky-bottom mt-5" style="border: none;border-top:0px">
      <div class="container" style="text-align: center; ">
        © Copyright 2024 Bumjini  . Powered by Jekyll with al-folio theme. Hosted by GitHub Pages.

      </div>
    </footer>
    
    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": 0 });
    $("progress-container").css({ "padding-top": 0 });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>
  </div></body>
  
  <d-bibliography src="/assets/bibliography/all.bib">
  </d-bibliography>
  <script src="/assets/js/distillpub/overrides.js"></script>

  <center>
    <a  href="">
    <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </a>
  </center>
  <hr> 

  </html>
