<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bumjini | [연구 9] Differentail Material Representation Learning</title>
    <meta name="author" content="Bumjini  " />
    <meta name="description" content="원료들을 벡터로 표현하고 임베딩하여 유사 원료를 확인하는 방법에 대한 논의" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🪴</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://fxnnxc.github.io/Pkolmar/kolmar_231122/">
    
    <!-- Dark Mode -->
    


    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams',
        inlineMath: [['$','$'], ['\\(','\\)']]
      },
      chtml: {
          scale: 1.0,
          minScale: .6,  
          mtextFontInherit: true,
          mtextInheritFont: true,
          merrorInheritFont: true,
        },
        svg: {
          scale: 1.2
        }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Distill js -->
    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    
  </head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "[연구 9] Differentail Material Representation Learning",
      "description": "원료들을 벡터로 표현하고 임베딩하여 유사 원료를 확인하는 방법에 대한 논의",
      "published": "November 17, 2023",
      "authors": [
        {
          "author": "Bumjin Park",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body class="sticky-bottom-footer">

    <!-- Header -->    
    <center>
      <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </center>
    <hr> 

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1 style="font-size: 32px;">[연구 9] Differentail Material Representation Learning</h1>
        <p>원료들을 벡터로 표현하고 임베딩하여 유사 원료를 확인하는 방법에 대한 논의</p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        

        <h2 id="report-info">Report Info</h2>

<div class="spanbox" style="width:40rem;background-color:#FFFDFD;">
  <ol>
    <li>👨🏻‍💻 <strong>Code Release</strong>:  Tag <a href="https://github.com/fxnnxc/kolmar/tree/v23.11.22.1" target="_blank" rel="noopener noreferrer">v23.11.22.1</a>
</li>
    <li>📂 <strong>Raw Data</strong> :  (<code class="language-plaintext highlighter-rouge">raw_data:receipt_3</code>)   <br> # 3.1 은 1차 및 2처 처방을 합치고 코드별로 합산한 데이터</li>
    <li>🗂️ <strong>Datasets</strong> :  (<code class="language-plaintext highlighter-rouge">ds:receipt_3_dl</code>)</li>
    <li>👾 <strong>Models</strong> :  MLP</li>
    <li>🦄 <strong>Trainers</strong> : (<code class="language-plaintext highlighter-rouge">code_learning</code>)</li>
    <li>📌 <strong>Related Notebooks</strong>
      <ul>
        <li><a href="https://github.com/fxnnxc/kolmar/blob/v23.11.22.1/labs/code_learning_1/code.ipynb" target="_blank" rel="noopener noreferrer">code.ipynb</a></li>
        <li><a href="https://github.com/fxnnxc/kolmar/blob/v23.11.22.1/labs/code_learning_1/eval.ipynb" target="_blank" rel="noopener noreferrer">eval.ipynb</a></li>
      </ul>
    </li>
  </ol>

</div>

<h2 id="1-표현-학습">1. 표현 학습</h2>

<p>수많은 원료에 대해서 일반화된 예측모델을 만들기 위해서는 고정된 예측모델에 대하여 <strong>원료에 대한 표현 벡터</strong>를 학습하는 방법이 효율적이다. 아래 예시처럼, 심층신경망은 원료들의 조합에 대해서 물성을 예측하며, 본 모델이 지원하는 특징은</p>
<ol>
  <li>유사한 원료에 대해서도 신경망은 동작해야 하며,</li>
  <li>새로운 원료에 대해서도 신경망은 동작해야 한다.</li>
</ol>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1_wfJ_FRhqQuspSR6RdZMXbu45LMSVZyj" style="width:100%"></p>

<p>이러한 요구 조건을 만족하기 위해서는 물성 예측 신경망을 계속적으로 변경하는 것이 아니라, 고정된 회귀 모형에 
원료에 대한 적절한 표현벡터를 찾는 경우, 혼합물 예측이 가능하도록 만들어야 한다. 
최종적으로 다음과 같이 원료에 대한 표현을 딥러닝을 학습하는 방식을 택하였다.</p>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1wISAwf7MlTLOcx1F6CZRbUUMZ7hsZG21" style="width:100%"></p>

<p>세부적인 모델 구조는 다음과 같이 원료에 대한 표현 벡터가 존재하고 함량에 대해서 곱한 상태로 혼합물 표현 벡터가 만들어진다. 
원료 표현 벡터들은 혼합된 상태에 대해서 Regressor 가 제대로 물성을 예측하도록 만들어 진다.</p>

<p><img src="https://drive.google.com/uc?export=view&amp;id=12cfRZdmVixeeQOBQs-R2HREDQiLcSX4p" style="width:100%"></p>

<h2 id="2-training-and-evaluation-performance">2. Training and Evaluation Performance</h2>

<p>수 많은 원료에 대해서 혼합된 벡터를 사용하여 예측하기 때문에, 혼합물 벡터의 차원은 저차원보다 고차원이 유리하다. 예를 들어서, 60개의 원료를 섞는 경우, 2차원 벡터라면 수많은 원료 표현에 대해서 2차원으로 응축된 형태를 만들어 예측하는 것이기 때문에, 충분한 정보를 담지 못할 가능성이 높다. 따라서 표현 벡터의 길이는 혼합물의 개수를 충분히 고려하도록 설계되어야 한다. 
아래 그림은 벡터 길이에 따른 성능 차이를 보여준다. 학습 데이터에 대해서는 0~10만 viscosity 에 대해서 1%미만의 에러를 보이며, 테스트 데이터에 대해서 5% 수준의 에러를 보인다.</p>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1Uy1gnHeRfZ64PcwRVxu85bOlShpK5pDS" style="width:100%"></p>

<p>세부적인 성능은 다음과 같다. <code class="language-plaintext highlighter-rouge">Full</code> 의 경우 전체 데이터에 대한 에러 수준이다.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">CODE_ACT</th>
      <th style="text-align: center">N_ENTRIES</th>
      <th style="text-align: center">STEP</th>
      <th>Full</th>
      <th>Eval</th>
      <th>Train</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">tanh</td>
      <td style="text-align: center">100</td>
      <td style="text-align: center">195000</td>
      <td><strong>1751</strong></td>
      <td><strong>5425</strong></td>
      <td><strong>176</strong></td>
    </tr>
    <tr>
      <td style="text-align: center">tanh</td>
      <td style="text-align: center">50</td>
      <td style="text-align: center">195000</td>
      <td><strong>1777</strong></td>
      <td><strong>5511</strong></td>
      <td><strong>177</strong></td>
    </tr>
    <tr>
      <td style="text-align: center">tanh</td>
      <td style="text-align: center">20</td>
      <td style="text-align: center">195000</td>
      <td><strong>1869</strong></td>
      <td><strong>5738</strong></td>
      <td><strong>210</strong></td>
    </tr>
    <tr>
      <td style="text-align: center">tanh</td>
      <td style="text-align: center">10</td>
      <td style="text-align: center">195000</td>
      <td><strong>1987</strong></td>
      <td><strong>6118</strong></td>
      <td><strong>216</strong></td>
    </tr>
    <tr>
      <td style="text-align: center">tanh</td>
      <td style="text-align: center">6</td>
      <td style="text-align: center">195000</td>
      <td><strong>2032</strong></td>
      <td><strong>6174</strong></td>
      <td><strong>257</strong></td>
    </tr>
    <tr>
      <td style="text-align: center">tanh</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center">195000</td>
      <td><strong>2037</strong></td>
      <td><strong>6217</strong></td>
      <td><strong>245</strong></td>
    </tr>
    <tr>
      <td style="text-align: center">tanh</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">195000</td>
      <td><strong>2295</strong></td>
      <td><strong>6731</strong></td>
      <td><strong>394</strong></td>
    </tr>
  </tbody>
</table>

<p>Evaluation 데이터에 대한 에러 수준이 높은 것은 크게 두 가지이다.</p>

<ol>
  <li>처음보는 원료에 대한 표현이 들어갔을 가능성</li>
  <li>기존 원료들의 조합이나, 배율이 처음보는 경우</li>
</ol>

<p>추후 연구에서는 에러가 높은 이유에 대해서 추가적인 분석이 필요하다.</p>

<h2 id="3-material-representation-visualization">3. Material Representation Visualization</h2>

<p>원료 표현 벡터 학습의 가장 큰 장점은 원료 표현 벡터에 대한 시각화를 통해서, 
각 원료들의 표현이 어떻게 구성되는지 살펴보는 것이다. 벡터에 대한 시각화는 2차원까지 가능하며, 
고차원의 경우 2차원으로 차원을 낮춰서 시각화해야 한다. 
아래 그림은 5400개 원료에 대한 2D 시각화 예시를 보여준다. X,Y 축은 2차원 벡터의 값이며, 
각 점들은 원료들이고, 색깔은 1번 원료부터 5400번 원료까지 순서를 나타낸 것이다.</p>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1nol_mRfIQiM9Qufizb-2PetMgdZEvd5z" style="width:100%"></p>

<p>해당 그림을 이해하는 방법은 다음과 같다. 중앙에 있는 원료의 경우, [0,0]에 위치해있으며, 원료 함량과 곱했을 때, 혼합물 벡터에 기여하는 값이 0이다. 따라서 <strong>물성 예측에 영향을 끼치지 않는 원료</strong>라고 이해할 수 있다. 
이와 반대로 1 혹은 -1 근처에 모여 있는 점들의 경우, 물성 예측에 큰 영향을 끼치는 원료들이며, 만일 점이 가깝다면 혼합물 예측에 비슷한 영향을 끼치는 원료로 이해할 수 있다. 이러한 해석은 실무자가 원료를 섞을 때 예상하는 영향을 <strong>딥러닝으로 모델링</strong> 한 것으로 이해할 수 있다.</p>

<h3 id="2-dimensional">2-Dimensional</h3>

<p>표현 벡터의 길이가 2인 경우, 원료 표현 벡터가 학습되는 과정을 시각화하면 다음과 같다.</p>

<ol>
  <li>초기 원료들은 모두 (0,0)에 모여 있다.</li>
  <li>학습이 진행됨에 따라서 원료들의 표현은 1차원적으로 분산된다.</li>
  <li>학습이 더욱 진행되면서 원료들의 표현 자체가 더욱 분산되며, 유사한 표현들은 서로 그룹을 이룬다.</li>
</ol>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1WXKeUiaP0YyRt-fvYoqF2Q4ltw24Xdhw" style="width:80%"></p>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1fKF3oOTyY8tTM8yTJlSQde9qKTAvD2oC" style="width:80%"></p>

<h3 id="high-dimensional">High Dimensional</h3>

<p>더욱 높은 고차원 (10, 100) 에 대한 시각화는 2D로 표현 벡터들을 projection 시키고 살펴봐야 한다. 
학습이 진행됨에 따라서 원료 표현들은 분산되며, 유사한 원료들은 표현 자체가 비슷한 곳에 형성된다.</p>

<div>
<img src="https://drive.google.com/uc?export=view&amp;id=1-sPcMbMBTNRk-g3yZx4KcQDBqhXtKg4y" style="width:45%">
<img src="https://drive.google.com/uc?export=view&amp;id=1YTtQmrQQ1reFN3rr-QM8_7e7VPr39HsO" style="width:45%">
</div>

<h3 id="representation-analysis">Representation Analysis</h3>

<p>원료 표현 자체가 모델에 어떠한 영향을 끼치는지, 실제 원료 표현이 유사하면, 실무자가 판단하기로도 유사한 물질인지 이해하기 위해서는 벡터 공간에 대해서 몇 개의 그룹들을 찾고 원료들을 분석해야 한다. 이러한 분석 방법은 “학습 데이터 수가 부족한 원료”가 있다면, 실무자가 표현 벡터를 강제하여 성능을 올릴 수도 있기에, 아주 중요하다.</p>

<p><img src="https://drive.google.com/uc?export=view&amp;id=17gJtCfauiNeZ2YrSHfIbosbXbdF35K1n" style="width:100%"></p>

<h2 id="결론">결론</h2>

<p>물성에 대한 인공지능을 하기 위해서 구분해야 하는 것은 두 가지이다. 첫 번째는 물성 자체에 대한 표현 벡터들을 고려하고, 벡터들의 특징을 이해하는 것이다. 두 번째는 표현 벡터를 활용하여 예측 모델을 만드는 것이다. 이 때 가정은 벡터 표현 자체가 유사하다면, 예측도 유사하다는 점이다. 두 가지를 구분하는 경우, 실무자는 표현벡터공간에 대한 해석을 토대로 물질들이 모델에 끼치는 영향을 이해할 수 있으며, 예측의 어려움을 딥러닝 알고리즘에 전가한다.</p>

      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>


      <hr>
<!--<div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script>
      let giscusTheme = localStorage.getItem("theme");
      let giscusAttributes = {
          "src": "https://giscus.app/client.js",
          "data-repo": "fxnnxc/fxnnxc",
          "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMjQ2NjUxMTU=",
          "data-category": "Q&A",
          "data-category-id": "DIC_kwDOE1n_G84CYOk_",
          "data-mapping": "title",
          "data-strict": "0",
          "data-reactions-enabled": "1",
          "data-emit-metadata": "0",
          "data-input-position": "top",
          "data-theme": giscusTheme,
          "data-lang": "en",
          "crossorigin": "anonymous",
          "async": "",
      };
  
  
      let giscusScript = document.createElement("script");
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById("giscus_thread").appendChild(giscusScript);
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript">comments powered by giscus.</a></noscript>
  </div>--><div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script>
      let giscusTheme = localStorage.getItem("theme");
      let giscusAttributes = {
          "src": "https://giscus.app/client.js",
          "data-repo": "fxnnxc/fxnnxc",
          "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMjQ2NjUxMTU=",
          "data-category": "Q&A",
          "data-category-id": "DIC_kwDOE1n_G84CYOk_",
          "data-mapping": "title",
          "data-strict": "0",
          "data-reactions-enabled": "1",
          "data-emit-metadata": "0",
          "data-input-position": "top",
          "data-theme": giscusTheme,
          "data-lang": "en",
          "crossorigin": "anonymous",
          "async": "",
      };
  
  
      let giscusScript = document.createElement("script");
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById("giscus_thread").appendChild(giscusScript);
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by giscus.</a>
</noscript>
  </div>
</div>

    <!-- Footer -->    <footer class="sticky-bottom mt-5" style="border: none;border-top:0px">
      <div class="container" style="text-align: center; ">
        © Copyright 2024 Bumjini  . Powered by Jekyll with al-folio theme. Hosted by GitHub Pages.

      </div>
    </footer>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": 0 });
    $("progress-container").css({ "padding-top": 0 });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>

  <d-bibliography src="/assets/bibliography/">
  </d-bibliography>

  <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="/assets/js/distillpub/overrides.js"></script>

    <center>
        <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </center>
    <hr> 

</html>
