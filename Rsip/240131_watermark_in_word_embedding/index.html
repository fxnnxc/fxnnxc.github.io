<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bumjini | Watermark in Word Embedding</title>
    <meta name="author" content="Bumjini  " />
    <meta name="description" content="" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🪴</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://fxnnxc.github.io/Rsip/240131_watermark_in_word_embedding/">
    
    <!-- Dark Mode -->
    


    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams',
        inlineMath: [['$','$'], ['\\(','\\)']]
      },
      chtml: {
          scale: 1.0,
          minScale: .6,  
          mtextFontInherit: true,
          mtextInheritFont: true,
          merrorInheritFont: true,
        },
        svg: {
          scale: 1.2
        }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Distill js -->
    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    
    <!-- Page/Post style -->
    <style type="text/css">
      .table {
    padding-top:200px;
    margin-bottom: 2.5rem;
    border-bottom: 2px;
} .p {
    font-size:20px;
}

    </style>
  </head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Watermark in Word Embedding",
      "description": "",
      "published": "January 31, 2024",
      "authors": [
        {
          "author": "Bumjin Park",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body class="sticky-bottom-footer">

    <!-- Header -->    
    <center>
      <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </center>
    <hr> 

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1 style="font-size: 32px;">Watermark in Word Embedding</h1>
        <p></p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        

        <h2 id="watermark-in-word-embedding">Watermark in Word Embedding</h2>

<p>주어진 단어 임베딩 공간 $E={e_1, e_2, \cdots, e_V}$에 대해서 문서 워터마크 임베딩$W={w_1, w_2, \cdots, w_M}$ where $w_j \sim \mathcal{N}(0, \sigma)$ 은 단어 임베딩 공간에 대해서 충분히 작은 variance 를 가져야 한다. 임베딩 $e_i$ 와 문서 워터마크 $w_j$ 를 입력에 넣는 경우를 가정하자.</p>

\[\hat{e}_i = e_i + w_j\]

<p>만일 $w_j$ 의 크기가 $e_i$ 들을 구분하는 거리보다 크다면, 랜덤하게 뽑은 $w_j$들은 다른 단어의 임베딩을 침범하게 된다. 따라서 문서 워터마크에 대해서는 다음과 같은 크기의 제약이 필요하다.</p>

\[|e_k -  e_i | &gt;  |w_j|\]

<p>아래 그림은 단어 임베딩 공간에서 문서 워터마크의 크기에 따른 영역 침범을 보여준다.</p>

<p><img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%21924&amp;authkey=%21AKqZxG_oAW8Ovmg&amp;width=593&amp;height=422" width="593" height="422" /></p>

<p>GPT를 학습하는 과정에서 단어 임베딩 공간은 업데이트 되므로 고정 값이 아니다. 이에 반해 문서 워터마크는 고정값을 가정하고 있다. 따라서 학습 과정에서 문서 워터마크를 넣는다면, 애시당초 충분히 작은 값을 고정적으로 줘야 한다. (물론, 문서 워터마크 표현도 differential 하게 학습하는 방식을 고려할 수 있을 것이다.)</p>

<p>이 경우, 가능한 방식은 문서 워터마크가 the unit $d-1$-sphere 에 존재하며, 충분히 작은 $\alpha$ 를 가진 공간에 놓는 것이다. 이는 기존 연구의 관점과 동일하다. 적절한 magnitude 에 대해서는 아직 밝혀내지 못했다.</p>

\[W = \{w \in \mathbb{R}^d | w_1^2 + w_2^2 + \cdots + w_d^2 = \alpha\}\]

<p>아래 그림은 학습 전 후로 고정된 unitary sphere 의 문서 워터마크와 임베딩 공간을 보여준다. 굳이 unitary sphere 를 쓰려는 이유는 normal distribution의 경우 그 값의 범위가 무한대이기 때문이다.</p>

<p><img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%21926&amp;authkey=%21AAstF537BgaczVA&amp;width=688&amp;height=300" width="688" height="300" /></p>

<h2 id="실험-결과">실험 결과</h2>

<p>Unitary Sphere 에 대해서는 좀더 논의가 필요하다. 이 실험에서는 normal distribution 에서 std 를 제어함으로써 학습 성능의 변화를 살펴봤다. std 가 증가할수록 초기화된 임베딩 공간을 넘는 문서 워터마크가 존재하며, 학습의 불안정성이 커진다.</p>

<p><img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%21930&amp;authkey=%21ABxtBfbqotaWBtk&amp;width=660" width="660" height="auto" /></p>

<h2 id="결론">결론</h2>

<p>임베딩 공간에 단어와 문서의 정보를 넣는 것은 둘 중 하나의 크기가 상대적으로 작을 때 가능하다. 
여기서는 단어 임베딩을 기준으로 문서 정보를 넣는 것을 고려하였다. 
반대로 문서 임베딩에 대해서 단어 임베딩을 넣는 것을 가정할 수도 있을 것으로 고려된다.</p>

      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>


      <hr>
<!----></div>

    <!-- Footer -->    <footer class="sticky-bottom mt-5" style="border: none;border-top:0px">
      <div class="container" style="text-align: center; ">
        &copy; Copyright 2024 Bumjini  . Powered by Jekyll with al-folio theme. Hosted by GitHub Pages.

      </div>
    </footer>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": 0 });
    $("progress-container").css({ "padding-top": 0 });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>

  <d-bibliography src="/assets/bibliography/all.bib">
  </d-bibliography>

  <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="/assets/js/distillpub/overrides.js"></script>

    <center>
        <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </center>
    <hr> 

</html>
