<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
    
<head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bumjini | </title>
    <meta name="author" content="Bumjini  " />
    <meta name="description" content="문서와 함께 넣고, 생성한 결과물로부터 문서를 유도하는 인-아웃 구조" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🪴</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://fxnnxc.github.io/Rsip/240111_in_and_out/">
    
    <!-- Dark Mode -->
    

  <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams',
        inlineMath: [['$','$'], ['\\(','\\)']]
      },
      chtml: {
          scale: 1.0,
          minScale: .6,  
          mtextFontInherit: true,
          mtextInheritFont: true,
          merrorInheritFont: true,
        },
        svg: {
          scale: 1.2
        }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  <!-- Distill js -->
  <script src="/assets/js/distillpub/template.v2.js"></script>
  <script src="/assets/js/distillpub/transforms.v2.js"></script>
  <script src="/assets/js/distillpub/overrides.js"></script>
  <!-- Page/Post style -->
  
  <!-- Page/Post style -->
  <style type="text/css">
    .table {
    padding-top:200px;
    margin-bottom: 2.5rem;
    border-bottom: 2px;
} .p {
    font-size:20px;
}

  </style>
</head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "",
      "description": "문서와 함께 넣고, 생성한 결과물로부터 문서를 유도하는 인-아웃 구조",
      "published": "January 10, 2024",
      "authors": [
        {
          "author": "Bumjin Park",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body style="padding-top:0px" class="sticky-bottom-footer"> 
    
    <!-- Header --><header>
      
      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm sticky-top">
        <div class="container">
          <img>
          <!-- <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;"> -->
          
          <a class="navbar-brand title font-weight-lighter" href="https://fxnnxc.github.io/" style="margin-left:20px ;">
              <!--Bumjini-->
           <span class="font-weight-bold" style="font-size:larger;font-family:Times New Roman;">Bumjini    </span>
        </a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <!-- <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/">  About Me</a>
              </li> -->
              
              <!-- Blog -->
              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_papers/"> Papers</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_articles/"> Articles</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_projects/"> Projects</a>
              </li>

              <!-- Other pages -->
              <li style="font-size: 17px" class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Others</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/side_papers/">🗂️ side-paper</a>
                  <a class="dropdown-item" href="/side_articles/">🥕 side-articles</a>
                  <a class="dropdown-item" href="/book/">📚 book (korean)</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1 style="font-size: 32px;"></h1>
        <p>문서와 함께 넣고, 생성한 결과물로부터 문서를 유도하는 인-아웃 구조</p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        

        <h2 id="인-아웃-구조">인-아웃 구조</h2>

<p>문서를 구분하여 메모리를 저장하는 것은 명시적인 메모리 사용을 유도하며 정보의 위치를 알 수 있는 중요한 단서이다. 
그러나 의존적으로 생성하는 것이 아닌, 입력 프롬프트에 기대어 생성하는 경우는 내부적으로 불명확한 정보를 사용하게 된다. 
현재까지 된 부분을 살펴보면 다음과 같다.</p>

<table>
  <thead>
    <tr>
      <th>연구</th>
      <th>정보의 위치</th>
      <th>프롬프트 의존 생성시 정보의 출처</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>기존 GPT 학습</td>
      <td>알 수 없음</td>
      <td>알 수 없음</td>
    </tr>
    <tr>
      <td>Guidance Memorization</td>
      <td>문서 수준까지 알 수 있음</td>
      <td>알 수 없음</td>
    </tr>
    <tr>
      <td>MinHash/LSH</td>
      <td>문서 수준까지 알 수 있음</td>
      <td>알 수 없음</td>
    </tr>
    <tr>
      <td>Source Identification</td>
      <td>알 수 없음</td>
      <td>End-to-End 맵핑으로 알 수 있음</td>
    </tr>
  </tbody>
</table>

<p>따라서 현재까지 진행된 연구에서는 <strong>정보의 위치</strong>를 알면서, <strong>정보 사용시 문서</strong>를 추정하는 것은 불가능하다. 
궁극적으로 우리에게 필요한 구조는 다음과 같다.</p>

<ol>
  <li>학습과정에서 문서에 대한 명확한 위치를 알 수 있도록 학습한다.</li>
  <li>문서에 대한 의존 없이 생성할 때, 생성물의 문서를 알 수 있도록 학습한다.</li>
</ol>

<p>메모리를 명시적으로 할당하는 것은 표현 자체에 대한 가정보다는 <strong>위치적인</strong> 가정이다. 따라서, 정보의 위치는 알 수 있지만, 
생성된 정보 자체의 의미를 해석해주지 못한다. 예를 들어, 1-5번 구멍에서 물이 나오면, 어떤 브랜드인지 아는 것과 물 맛을 보고 물을 아는 것은 다르다. 
따라서 추가적인 연구에서는 위치적인 가정보다 표현에 정보가 녹아 있다는 가정을 해야 한다.</p>

<ul>
  <li>물 : 평창수, 삼다수, 아이시스</li>
  <li>생성물 : 녹차, 홍차, 커피</li>
</ul>

<p>위의 예시에서 만일 생성물을 만드는 학습과정에서 다른 물의 종류가 들어가며, 생성할 때는 원래 물의 정보를 뽑아내고 싶다고 하자. 여기서 물과 생성물 자체는 관계가 존재하지 않는다. 
만일 우리가 생성물을 만드는 과정을 학습하면서 물에 대한 표현을 집어넣고, 생성물로부터 다시 물의 표현을 뽑아내고 싶다고 하면, 가장 간단한 구조는 다음과 같다.</p>

<h2 id="비유--요리사">비유 : 요리사</h2>

<p>내가 파견을 보낸 요리사는 여러 나라를 돌아다니며 계란 요리 만드는 방법을 배웠다. 
요리사에게 계란을 주면 본인이 직접 요리를 하면서 다양한 계란요리를 만들 수 있다. 
어느날 나는 요리사가 건낸 계란말이를 먹으며, 어떤 나라의 요리인지 궁금했다.<br>
“어떤 나라에서 배운 요리인가요?”
요리사는 대답했다. 
계란의 신선도, 날씨를 봤을 때 오늘은 오믈렛을 만든 겁니다.”
나는 레시피를 만든 나라를 알려달라고 했고, 
요리사는 다시 계란 크기와 날씨를 봤을 때 오믈렛이 적합헀다고 한다.</p>

<p>나는 요리사를 다시 파견 보내면서 이번에는 어떤 나라의 요리인지 제대로 구분해서 배우라고 말했다. 
몇달 후 요리사는 돌아와 나에게 계란찜을 건낸다. 나는 계란찜이 어느 나라 요리냐고 물어봤고 한국에서 만드는 방법이라고 말해줬다. 
며칠 후 나는 계란말이를 먹고 있었고, 요리사는 한국 또는 일본식이라고 말한다.</p>

<p>나는 요리사에게 어떻게 국가를 기억해냈냐고 물었다. 
요리사는 계란 요리가 별로 없으니, 그냥 만들고 나서 암기했다고 말헀다. 
나는 다시 요리사에게 물었다. 
“그럼 요리하는 중간에는 국가를 기억하지 않는 건가요?” 
요리사는 그렇다고 대답헀다.</p>

<p>나는 사실을 확인하기 위해 비서가 찍어준 요리사의 연수 사진을 내밀며 말했다. 
“이 사진이 어떤 나라에서 배우는 건지 기억나나요?”
요리사는 대답했다. 
“완성된 요리 사진을 보여주시면 대답할 수 있습니다. 나는 계란말이가 어떤 나라인지 압니다. 그러나, 중간 과정은 어떤 나라인지 모릅니다.”</p>

<p>나는 요리사를 다시 파견 보내면서 말했다. 
“이번에는 배우는 과정 모든 곳에 내가 어떤 나라에서 배우는지 기억할 수 있게 배워오세요.” 
요리사는 그러려면 요리를 배우는 과정과 나라를 기억하는 과정을 계속해야 하지 않냐고 투덜거렸다.</p>

<p>이번에 요리사는 더 오랜 시간이 걸려 파견을 다녀왔다. 
나는 돌아온 요리사에게 다시 계란 요리를 하나 만들어달라고 했다. 
요리를 시작하기 전, 나는 요리사에게 물었다. 어떤 나라의 요리를 만들고 있어?
요리사는 대답했다. 
“그건 아직 정하지 않았습니다.”</p>

<p>요리사는 계란요리를 만들기 시작했고, (추측하건데, 날씨와 기분에 따라서 확률적으로 행동하는 것 같다.)
나는 요리사에게 어떤 나라의 요리를 만들고 있냐고 물었다. 
저번과 다르게 이번에는 요리사가 대답을 줬다. 
지금 방식은 유럽식 계란 요리를 만드는 겁니다.</p>

<p>나는 요리사에게 어떻게 기억했냐고 물었다. 
그는 대답했다.</p>

<p>“이 과정은 유럽에게 특히 많이 사용되는 방법입니다. 제가 정확히 어떤 지역의 계란요리를 만들진 모르겠지만, 
적어도 유럽식인건 알 수 있습니다.”</p>

<p>요리가 거의 끝나갈 때, 요리사는 갑자기 놋그릇에 계란요리를 옮겨담고 있었다. 
나는 왜 유럽식인데 놋그릇에 담냐고 물었다. 요리사는 말했다. 
“일반 접시보다는 한국에서 사용되는 접시에 담는 것도 나쁘지 않을 것 같아서요. 
제가 요리하는 과정에서 유럽식으로 시작한 건 맞지만, 중간에 사용한 도구들은 일본식이었고 
담은 그릇은 한국식입니다.”</p>

<p>나는 요리사에게 물었다.
“그냥 유럽 요리니까, 유럽에서 배운대로 하면 되잖아”</p>

<p>요리사는 말했다. 
“제가 유럽식 요리를 배운 건 맞지만, 사장님은 한국사람이니, 놋그릇을 좋아할 것 같아서요.
“놋그릇은 한국 경주에서 계란전을 배울 때 사용하는 방식이었습니다”</p>

<p>나는 문득 요리사가 모든 요리과정과 지역을 연결한 방법이 궁금해졌다. 
요리사는 대답했다.</p>

<p>“계란을 보며 무엇을 만들지, 어떻게 처리할지 생각하는 그 모든 과정에서 저는 정보를 책에 기록해뒀기에 지역인지 대답할 수 있었습니다.
그러니, 제가 떠오른 정보들은 모두 어떤 지역인지 자명하죠.”</p>

<p>알고보니 요리사는 책이 있었고, 책을 참조해서 요리했으며, 
국가는 그 책에 적힌 지역을 말해주는 것이었다. 
나는 책을 압수하고 이번에 다시 요리사를 파견 보내며 말했다. 
“이번에는 아무것도 적지 말고 기억해봐.”</p>

<p>다시 돌아온 요리사는 놀랍게도 이번에도 국가를 잘 말해줬고 나는 어떻게 한 거냐고 물었다.</p>

<p>“제가 떠올린 정보는 놋그릇이 이지만, 정확하게는 ‘대청마루의 놋그릇 입니다. 제가 떠올린 정보와 사용한 정보가 달랐기에 
제가 떠올린 대청마루로부터 한국이라고 알려드린 겁니다.”</p>

<p>대단한 요리사는 단순히 놋그릇이 아닌 더 많은 정보를 암기하고 있었다. 
나는 요리사에게  비빔밥은 어떻게 기억하냐고 물었고, 그는 전주한옥마을을 이야기 했다.</p>

<p>결국 요리사가 최종적으로 암기한 것은 단순히 요리과정이 아닌, 요리가 놓은 장소를 포함했던 것이다. 
그리고 그 장소들은 동일한 국가여도 다양하게 형성되어 있었고, 국가를 떠올리기에 아주 쉽게 형성되어 있었다.</p>

<p>나는 요리사에게 한 번 더 물었다.
그냥 대청마루에 놋그릇과 비빔밥을 모두 기억하면 되지 않았냐고. 그럼 좀더 적은 용량으로 기억하지 않았냐고. 
요리사는 대답한다. 비빔밥은 전주와 연결해서 외우는 게 차라리 쉬웠다고. 오히려 비빔밥을 놋그릇과 연결하는 게 쉽지 않았다고 한다.</p>

<p>나는 이제 요리사를 파견 보내지 않는다. 
요리사는 내가 원하는 국가 정보를 요리하는 과정에서 언제든 줄 수 있기 떄문이다. 
요리사가 국가를 암기하는 방법은 요리과정을 국가와 관련된, 그리고 외우기 쉬운 정보로 매칭하는 것이었다. 
국가마다 랜드마크는 다시 많겠지만, 서로 구분되는 랜드마크가 도움이 되었다고 한다.</p>

<p>근데, 요리사야. 대청마루는 일본에도 있을 수 있잖아? 대청마루를 떠올려서 한국 요리라는 건 오류가 아닐까?
요리사는 대답한다. 
“대청마루를 일본에서도 사용했다면,, 큰일이었겠어요.”</p>

<hr>

<p>특정한 벡터에 물종류의 정보가 특정 dimension에 그대로 유지된 상태로 올라가는 것이다.</p>

<p>[물종류, 녹차잎1, 녹차잎2,…] –&gt; [물종류, 녹차]</p>

<p>두 번째 경우는 출력 자체에 물종류가 녹아 있는 경우다.</p>

<p>[물종류, 녹차잎1, 녹차잎2,…] –&gt; [녹차] –&gt; [물종류 유추]</p>

<p>세 번째 경우는 입력에 물종류가 녹아 있으며, 출력은 따로 존재하는 경우다.</p>

<p>[물종류] -&gt; [녹차잎1, 녹차잎2] –&gt; [물종류, 녹차]</p>

<p>마지막 경우는 두 가지 표현 모두에 물 종류가 녹아있는 경우다.</p>

<p>[물종류] -&gt; [녹차잎1, 녹차잎2] –&gt; [녹차] –&gt; [물종류]</p>

<p>이러한 모델링은 결국 (X,Y)에 대해서 conditional distribution을 만드는 것과 유사하다고 본다.</p>

<ul>
  <li>X : 물종류</li>
  <li>Y : 녹차잎</li>
  <li>\hat{Y} : 녹차</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>P(Y</td>
          <td>X) –&gt; P(\hat{Y}</td>
          <td>Y) –&gt; P(X</td>
          <td>\hat{Y})</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>P(\hat{Y}</td>
          <td>X,Y) –&gt; P(X</td>
          <td>\hat{Y})</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<p>위 네가지 경우 중에서 가장 우선적으로 연구할 부분은 1번, 입력의 특정 차원에 문서 정보가 들어가고, 출력을 학습하는 과정에서 다시 복원하는 경우다. 이 때, hidden dimension 의 일부분은 문서를 추정하기 위한 부분으로 남는다.</p>
<d-footnote> 문서에 대한 dependency 를 넣고 학습하는 것과, dependency 넣지 않고 학습하는 게 같아지도록 Loss를 설정하면 문서의 의존성을 없앨 수 있지 않을까? </d-footnote>

<h2 id="가장-간단한-가정">가장 간단한 가정</h2>

      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

<!--
    </div>
 -->
      <hr>
<!-- Footer -->    <footer class="sticky-bottom mt-5" style="border: none;border-top:0px">
      <div class="container" style="text-align: center; ">
        © Copyright 2024 Bumjini  . Powered by Jekyll with al-folio theme. Hosted by GitHub Pages.

      </div>
    </footer>
    
    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": 0 });
    $("progress-container").css({ "padding-top": 0 });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>
  </div></body>
  
  <d-bibliography src="/assets/bibliography/all.bib">
  </d-bibliography>
  <script src="/assets/js/distillpub/overrides.js"></script>

  <center>
    <a  href="">
    <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </a>
  </center>
  <hr> 

  </html>
