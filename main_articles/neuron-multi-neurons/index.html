<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
    
<head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bumjini | Multi-neuron Analysis</title>
    <meta name="author" content="Bumjini  " />
    <meta name="description" content="Regarding a method to interpret multiple neurons simultaneously.<br> [üìö Neuron Series 3]" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü™¥</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://fxnnxc.github.io/main_articles/neuron-multi-neurons/">
    
    <!-- Dark Mode -->
    

  <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams',
        inlineMath: [['$','$'], ['\\(','\\)']]
      },
      chtml: {
          scale: 1.0,
          minScale: .6,  
          mtextFontInherit: true,
          mtextInheritFont: true,
          merrorInheritFont: true,
        },
        svg: {
          scale: 1.2
        }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  <!-- Distill js -->
  <script src="/assets/js/distillpub/template.v2.js"></script>
  <script src="/assets/js/distillpub/transforms.v2.js"></script>
  <script src="/assets/js/distillpub/overrides.js"></script>
  <!-- Page/Post style -->
  
</head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Multi-neuron Analysis",
      "description": "Regarding a method to interpret multiple neurons simultaneously.<br> [üìö Neuron Series 3]",
      "published": "August 11, 2023",
      "authors": [
        {
          "author": "Bumjin Park",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body style="padding-top:0px" class="sticky-bottom-footer"> 
    
    <!-- Header --><header>
      
      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm sticky-top">
        <div class="container">
          <img>
          <!-- <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;"> -->
          
          <a class="navbar-brand title font-weight-lighter" href="https://fxnnxc.github.io/" style="margin-left:20px ;">
              <!--Bumjini-->
           <span class="font-weight-bold" style="font-size:larger;font-family:Times New Roman;">Bumjini    </span>
        </a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <!-- <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/">  About Me</a>
              </li> -->
              
              <!-- Blog -->
              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_papers/"> Papers</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_articles/"> Articles</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_projects/"> Projects</a>
              </li>

              <!-- Other pages -->
              <li style="font-size: 17px" class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Others</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/side_papers/">üóÇÔ∏è side-paper</a>
                  <a class="dropdown-item" href="/side_articles/">ü•ï side-articles</a>
                  <a class="dropdown-item" href="/book/">üìö book (korean)</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1 style="font-size: 32px;">Multi-neuron Analysis</h1>
        <p>Regarding a method to interpret multiple neurons simultaneously.<br> [üìö Neuron Series 3]</p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        

        <h2 id="introduction">Introduction</h2>

<p>Deep neural network has lots of parameters in its module. When we group parameters by the minimal meaningful components, we can consider a concept neuron which is known to have meaningful concepts or patterns <d-cite key="mcgrath2022acquisition"></d-cite><d-cite key="cammarata2020thread"></d-cite><d-cite key="leike2023language"></d-cite>. Recent work both quantitatively and qualitatively dissects individual neurons in a deep neural network. However, most of them handle a single neuron at a time. They do not analyze multiple neurons at a single time as the combination of neurons is complex. Even though the combination is hardly understood, work on the combination is essential in the field of interpretability and explainability of AI as the interaction between neurons is the fundamental property of a deep neural network. In addition, previous work assumes that the individual neurons have meanings and the emerged knowledge is a linear combination of those concepts. However, it may be possible that a single neuron does not have meaning, while the combination of multiple neurons does. That is, the directional information is meaningful, and the individual basis is not. Therefore, analysis of multiple neurons is essential to understand deep neural networks. To do this, <strong>this post provides a way to interpret multi-neuron and the visualization of them</strong>.</p>

<h2 id="multi-neuron-in-linear-layer">Multi-neuron in Linear Layer</h2>

<p>In this post, we only handle multi-neuron in a linear layer as most complex modules are the mixture of linear layers. If you require preliminaries on neurons in a linear layer, please check this [<a href="https://fxnnxc.github.io/main_articles/neuron_in_neuroscience/#:~:text=the%20connected%20neuron.-,Deep%20Learning,-Neuron%20%26%20Synapse">post</a>]. The summary of multi-neuron in a linear layer is as follows</p>
<ul>
  <li>a neuron in a linear layer is each row</li>
  <li>the number of neurons in a linear layer is the size of row</li>
  <li>the number of synapses (connections) is the size of column</li>
</ul>

<p>The multi-neuron that we consider is $m$ neurons with $n$ synapses which interpret $n$-dimensional input.</p>

<h2 id="interpretation-of-multi-neuron">Interpretation of Multi-neuron</h2>

<p>With a definition that column size is the processed information dimension for each neuron, we only consider size 1 and 2 dimensional size input as larger than 3 dimensional size input could not be visualized. 
The Figures below show two neurons which process 1D input and 2D input. We represent each entry of input as <code class="language-plaintext highlighter-rouge">F</code> and the neuron‚Äôs output with <code class="language-plaintext highlighter-rouge">A</code>. In addition, we use red color for positive output and green color for negative output<d-footnote> Note that the activation is the post-process of the output, such as with ReLU or Sigmoid.</d-footnote>. Each neuron has parameters: $w,b$ for a 1D input neuron and $w_1,w_2,b$ for 2D input neuron. For all Figures, the up-direction is the neuron output and the other dimensions are the input dimension (we highlighted the yellow regions).</p>

<figure>
<img src="/assets/kor/neurons_as_neurons/decision_boundary.png">
<figcaption>
Figure. Illustration of multi neuron outputs. Note that two neurons output positive and negative scalars each with the same input (<code>F</code> for 1D input or <code>FF</code> for 2D input). The yellow regions are input regions and we consider only positive regions <d-footnote> As the inputs of most neurons are the activated signal of the previous neurons with ReLU for example.  </d-footnote>. Unlike the input space, the output could be either positive or negative. (Left) The multi-neuron example with 1D input (column size of a linear weight  is 1).  (Right) The multi-neuron example with 2D input (column size of a linear weight is 2). 
</figcaption>
</figure>

<p>Note that these visualizations require +1 dimensional space of input space as a neuron output scalar. This is why we can interpret maximally  multiple neurons with 2D input size as the visualization requires 3D space. We said that a neuron can output  either positive or negative scalars. We analyze the change of signs as it highly affects the behavior of neurons. Optionally, we can analyze the output of neurons with 95% quantiles. That is, we analyze whether a neuron gives a high scalar for an input or not.</p>

<h2 id="visualization-of-multi-neuron">Visualization of multi-neuron</h2>

<p>In this section, we provide visualization results of neurons for all positive input values. We use random weight $W \in \mathbb{R}^{8\times1}$ and bias $b \in \mathbb{R}^{8}$. In this case, the number of neurons is  8 and the input dimension is 1. In addition, we specifically highlight two cases, Input 1 and Input 2.</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">input 1</code>  is small signal  0.3</li>
  <li>
<code class="language-plaintext highlighter-rouge">input 2</code>  is large signal : 0.7</li>
</ul>

<p>The visualization shows individual neurons as a line 
\(y = w_n x +b_n\)
where $x$ is the input and  $y$ is the output of the neuron which has weight $w_n$ and bias $b_n$. These lines are guidelines to show how neurons give outputs. For <code class="language-plaintext highlighter-rouge">input 1</code> and <code class="language-plaintext highlighter-rouge">input 2</code>, you have to check only $x=0.3$ and $x=0.7$ respectively.</p>

<figure>
<iframe src="/assets/plotly/decision_boundary.html" frameborder="0" scrolling="no" height="500px" width="100%" style="border:0px dashed grey;"></iframe>
<figcaption>
Figure. The visualization of 8 neurons with guidelines and specific inputs  $x=0.3$ and $x=0.7$. We also provide scatter points with color red for positive outputs and blue for negative outputs. As the input increases from $0.3$ to $0.7$, the output of neuron 3 becomes negative and other neurons do not change the sign of output. 
</figcaption>
</figure>

<hr>

<h2 id="input-boundary">Input Boundary</h2>

<p>In the previous section, we described the change of sign for outputs. This observation remains the following question on the input regions. <em>Can we dissect input regions and discover meaningful regions?</em> This question is naive but related to more interesting problems. For example, CLIP <d-cite key="radford2021learning"></d-cite> model has multi-model representation space. Can we partition the input regions properly so that we can clearly understand the space? To answer this question, we first know exactly the properties of the space. Like this, input regions of a deep neural network <strong>can be partitioned</strong> for interpretability and explainability.</p>

<p>We partition the input space with the sign of the output for neurons. With the Figure below, you might notice that the partitioned regions are determined by the points of intersection. In addition, at each point, the behavior of a neuron could be increasing or decreasing which is determined by the slope of a line (sign of weight). Therefore, for the clear description, we should visualize two things</p>
<ul>
  <li>The points of intersection  (üìê)</li>
  <li>The sign of slope  (üî¥, üü¢)</li>
</ul>

<p>To this end, we have the following visualization of neurons and input boundaries for 1D input.</p>

<figure>
<iframe src="/assets/plotly/decision_boundary_1d.html" frameborder="1" scrolling="no" height="520px" width="100%" style="border:0px dashed grey;"></iframe>
</figure>

<p>You can visualize only the input region removing the guidelines of neurons.</p>

<figure>
<iframe src="/assets/plotly/decision_boundary_1d_input.html" frameborder="0" scrolling="no" height="520px" width="100%" style="border:0px dashed grey;"></iframe>
</figure>

<h4 id="2d">2D</h4>

<p>Now we visualize 2D input space in which a neuron has a single output, and in total requires 3D visualization for neuron behavior. The visualization technique is the same with the case of 1D visualization. The only difference is that now a boundary is a line instead of a point and a guideline for a neuron is a plane instead of a line. The Figure below shows visualization of random neurons with projection on the xy-plane (a region where the sign of a neuron changes).</p>

<figure>
<iframe src="/assets/plotly/decision_boundary_2d.html" frameborder="1" scrolling="no" height="520px" width="100%" style="border:0px dashed grey;"></iframe>
</figure>

<p>Similarly, we can visualize the input boundaries without the guidelines. We visualize the green region as the region where the neuron‚Äôs output is positive and the red region as the region where the neuron‚Äôs output is negative. With this visualization technique, we can interpret the signs of two Regions (Skyblue and Magenta).</p>

<figure>
<iframe src="/assets/plotly/decision_boundary_2d_input.html" frameborder="0" scrolling="no" height="520px" width="100%" style="border:0px dashed grey;"></iframe>
</figure>

<p>Such a visualization provides a much deeper understanding of input regions. Imagine that we have an input in Region1 and move it to Region2. With such a change we expect the positive output of  Neuron 1 as the color goes from <code class="language-plaintext highlighter-rouge">Red</code> to <code class="language-plaintext highlighter-rouge">Green</code>.</p>

      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

<!--<div id="disqus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script type="text/javascript">
        var disqus_shortname  = 'al-folio';
        var disqus_identifier = '/main_articles/neuron-multi-neurons';
        var disqus_title      = "Multi-neuron Analysis";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </div>
 -->
      <hr>
<div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script>
      let giscusTheme = localStorage.getItem("theme");
      let giscusAttributes = {
          "src": "https://giscus.app/client.js",
          "data-repo": "fxnnxc/fxnnxc",
          "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMjQ2NjUxMTU=",
          "data-category": "Q&A",
          "data-category-id": "DIC_kwDOE1n_G84CYOk_",
          "data-mapping": "title",
          "data-strict": "0",
          "data-reactions-enabled": "1",
          "data-emit-metadata": "0",
          "data-input-position": "top",
          "data-theme": giscusTheme,
          "data-lang": "en",
          "crossorigin": "anonymous",
          "async": "",
      };
  
  
      let giscusScript = document.createElement("script");
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById("giscus_thread").appendChild(giscusScript);
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by giscus.</a>
</noscript>
  </div>
<!-- Footer -->    <footer class="sticky-bottom mt-5" style="border: none;border-top:0px">
      <div class="container" style="text-align: center; ">
        ¬© Copyright 2024 Bumjini  . Powered by Jekyll with al-folio theme. Hosted by GitHub Pages.

      </div>
    </footer>
    
    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": 0 });
    $("progress-container").css({ "padding-top": 0 });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>
  </div></body>
  
  <d-bibliography src="/assets/bibliography/all.bib">
  </d-bibliography>
  <script src="/assets/js/distillpub/overrides.js"></script>

  <center>
    <a  href="">
    <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </a>
  </center>
  <hr> 

  </html>
