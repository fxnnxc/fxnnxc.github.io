<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
    
<head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bumjini | Review on causality for mechanistic interpretability in ICML 2024</title>
    <meta name="author" content="Bumjini  " />
    <meta name="description" content="Literature reviews on ICML 2024 mechanistic interpretability workshop oral and spotlight papers." />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü™¥</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://fxnnxc.github.io/main_articles/240713_mi1/">
    
    <!-- Dark Mode -->
    

  <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams',
        inlineMath: [['$','$'], ['\\(','\\)']]
      },
      chtml: {
          scale: 1.0,
          minScale: .6,  
          mtextFontInherit: true,
          mtextInheritFont: true,
          merrorInheritFont: true,
        },
        svg: {
          scale: 1.2
        }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  <!-- Distill js -->
  <script src="/assets/js/distillpub/template.v2.js"></script>
  <script src="/assets/js/distillpub/transforms.v2.js"></script>
  <script src="/assets/js/distillpub/overrides.js"></script>
  <!-- Page/Post style -->
  
  <!-- Page/Post style -->
  <style type="text/css">
    .table {
    padding-top:200px;
    margin-bottom: 2.5rem;
    border-bottom: 2px;
} .p {
    font-size:20px;
} .center{
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
}

  </style>
</head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Review on causality for mechanistic interpretability in ICML 2024",
      "description": "Literature reviews on ICML 2024 mechanistic interpretability workshop oral and spotlight papers.",
      "published": "July 13, 2024",
      "authors": [
        {
          "author": "Bumjin Park",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body style="padding-top:0px" class="sticky-bottom-footer"> 
    
    <!-- Header --><header>
      
      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm sticky-top">
        <div class="container">
          <img>
          <!-- <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;"> -->
          
          <a class="navbar-brand title font-weight-lighter" href="https://fxnnxc.github.io/" style="margin-left:20px ;">
              <!--Bumjini-->
           <span class="font-weight-bold" style="font-size:larger;font-family:Times New Roman;">Bumjini    </span>
        </a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <!-- <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/">  About Me</a>
              </li> -->
              
              <!-- Blog -->
              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_papers/"> Papers</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_articles/"> Articles</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_projects/"> Projects</a>
              </li>

              <!-- Other pages -->
              <li style="font-size: 17px" class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Others</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/side_papers/">üóÇÔ∏è side-paper</a>
                  <a class="dropdown-item" href="/side_articles/">ü•ï side-articles</a>
                  <a class="dropdown-item" href="/book/">üìö book (korean)</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1 style="font-size: 32px;">Review on causality for mechanistic interpretability in ICML 2024</h1>
        <p>Literature reviews on ICML 2024 mechanistic interpretability workshop oral and spotlight papers.</p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        

        <h2 id="missed-causes-and-ambiguous-effects-counterfactuals-pose-challenges-for-interpreting-neural-networks">Missed Causes and Ambiguous Effects: Counterfactuals Pose Challenges for Interpreting Neural Networks</h2>

<p>Researchers in mechanistic interpretability (MI) aims to prove the effect of nodes in neural networks. The causal analysis plays a crucial role in this field. This paper aims to criticize the misuses of causal interpretation in MI based on the traditional pitfalls of interpretations in causality.</p>

<p>The <strong>counterfactual theory of causality (Lewis, 1973)</strong> is a useful to to analyze the causal relationship, but the MI researchers do not consider the pitfalls of interpretation with counterfactual analysis. The two problems are</p>
<ol>
  <li>
<strong>Overdetermination</strong> : simultaneous and similar causes of the same effect are missed.</li>
  <li>
<strong>Non-transitivity</strong> : $(A \rightarrow B)$ and $(B \rightarrow C)$ hold, but $(A \rightarrow C)$ is not guaranteed.</li>
</ol>

<p>Some of the meanings of causality are</p>

<blockquote>
  <p>David Hume (1748): <br> ‚ÄúA cause, if the first object had not been, the second had never existed‚Äù</p>
</blockquote>

<p>Lewis (1973) poses that</p>

<blockquote>
  <p>An event $E$ causally depends on $C$ iff (1) if $C$ had occurred, then $E$ would have occurred, and (2) if $C$ had not occurred, then $E$ would not have occurred.</p>
</blockquote>

<p>Note that the <text style="color:blue"> counterfactual dependence is sufficient but not necessary for causation. </text>  In other word, the causal dependency between two variables can exist without the counterfactual condition<d-footnote>I think, here the counterfactual dependence means that "E" had never existed, then "C" has not been. Therefore, other types of causality exist except the counterfactual relationship. </d-footnote>. This means that the counterfactual dependence is the strong dependency between two variables. I think this may be the most strong causal relationship (not confident).</p>

<h2 id="1-non-transitive-example">1 Non-transitive example</h2>

<p>Consider three events</p>
<ul>
  <li>$A$: A hiker is walking up a mountain. A large boulder begins rolling down the mountain toward the hiker.</li>
  <li>$B$: The hiker, noticing the rolling boulder, ducks out of the way</li>
  <li>$C$: The hiker lives.</li>
</ul>

<p>Here the sequence of events $A\rightarrow B \rightarrow C$ occurs. Clearly there is two causal relationships</p>
<ul>
  <li>$A\rightarrow B$ : the hiker avoids the boulders. He would have not avoided the ball if event $A$ had not been occurred (If the stone did not roll).</li>
  <li>$B\rightarrow C$ : He survived because he noticed the boulder and avoided. Ho would have not lived if event $B$ had not been occurred (If he did not see the stone).</li>
</ul>

<p>However, there is no causality between the rolling stone and the survival because it is determined by the mediator (the action of the hiker).</p>

<h4 id="11-transitive-example">1.1 transitive example</h4>

<p>The transitivity property is a key to <strong>actual causality</strong>.
There are many cases where transitivity holds such as hitting balls.</p>
<ul>
  <li>$A$ : a man hits Ball $A$.</li>
  <li>$B$ : the ball $A$ hits the ball $B$.</li>
  <li>$C$ : the ball $B$ hits the ball $C$.</li>
</ul>

<p>Note that $A \rightarrow C$ holds when $A \rightarrow B$ and $B \rightarrow C$  hold.</p>

<h4 id="-12-insights-on-neural-networks">üí° 1.2 Insights on Neural Networks</h4>

<p>A neural network has several internal nodes and nodes are computed sequentially to produce the final output. 
It is meaningful that the transitive property does not exists. For example, the activation of circular pattern cause the activation of dog nose pattern and sequentially the dog nose pattern cause the prediction of a dog. However, the causal dependency between <strong>circular pattern</strong> and <strong>dog label</strong> is weak.</p>

<p>However, the most important analysis in LLMs is the causality between semantic features rather than the progressive features which makes the high level concepts in the forward process of neural networks.</p>

<p>Another note is about the importance of transitivity. In MI, the circuit analysis is important to fully reverse engineer the neural networks. When we analysis the relationship between neurons over different layers, the causality can provide the overview of the computational graph.</p>

<h4 id="13-indirect-effect">1.3 Indirect Effect</h4>

<p>Consider you started watching youtube and you want to find the causality of increasing the knowledge of causality. 
Trivially, there is no relationship between these two. 
However, as a mediator, there is a causality youtube which increase the knowledge with high probability. As a result the causality from youtube and knowledge happens.</p>

<p>In this example, you want to localize the effect of the causality youtube. 
You can do this by measuring the</p>

<blockquote>
  <p>indirect effect = total effect (your score) - ablated effect (don‚Äôt watch the causality youtube)</p>
</blockquote>

<p>You can run this experiment on neural network by ablating the neurons. Therefore, you measure the contribution of neurons to the outputs within the context of input forward pass.</p>

<h4 id="14-when-transitive-holds">1.4 When transitive holds?</h4>

<p>Consider three variables and rules</p>

<ol>
  <li>$A=a_1 \rightarrow B = b_1$</li>
  <li>$B=b_1 \rightarrow C = c_1$</li>
  <li>$c_1 \ne c_2$</li>
  <li>$A=a_2 \rightarrow B =b_2$</li>
  <li>$ (A = a_2 \land B= b_2) \rightarrow C = c_2$</li>
</ol>

\[\begin{pmatrix}
A &amp; &amp; B &amp; &amp; C \\
1 &amp; \rightarrow &amp; 1 &amp; \rightarrow &amp;  1 \\
2 &amp; \rightarrow &amp; 2 &amp; \rightarrow &amp; 2 \\
\end{pmatrix}\]

<p>Additional set of sufficient conditions to guarantee transitivity is</p>

<ol>
  <li>For every value $b$ that $B$ can take, there exists a value $a$ that $A$ can take such that $A=a \rightarrow B=b$</li>
  <li>$B$ is in every causal path from $A$ to $C$.</li>
</ol>

<blockquote>
  <p>This formulation may shed a light on a path towards transitive variable learning in neural networks. However, the restrictions are somewhat too strict to be naively implemented. <br><br> The second condition may inspire a bottleneck structure in a neural network where representations are encapsulated on a specific layer.</p>
</blockquote>

<h2 id="2-overdetermination-example">2 Overdetermination example</h2>

<p>In MI, the counterfactual analysis assumes that a given node contributes to the output. Within this assumption, several studies verify the contribution of a given node. However, it is clear that</p>
<ol>
  <li>A node may causal relationship with mediators and the actual causal may not be captured.</li>
  <li>The joint relationship between nodes exists and verification on a single node does not highlight the genuine mechanism of components.</li>
</ol>

<p>Consider the example. When we throw a ball to wine glass, it will be broken. 
Now two people throw balls independently and we observe the broken wine glass. A question for causality is as follows</p>

<ul>
  <li>Does the ball thrown by the first person cause the break?</li>
  <li>Does the ball thrown by the second person cause the break?</li>
</ul>

<p>Well, we can not verify this and to variables are linked to the event ‚Äúbroken wine glass‚Äù.</p>

<table>
  <thead>
    <tr>
      <th>¬†</th>
      <th>First Person Hit</th>
      <th>Second Person Hit</th>
      <th>Broken Glass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Case 1</td>
      <td>O</td>
      <td>X</td>
      <td>O</td>
    </tr>
    <tr>
      <td>Case 2</td>
      <td>X</td>
      <td>O</td>
      <td>O</td>
    </tr>
    <tr>
      <td>Case 3</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
    </tr>
    <tr>
      <td>Case 4 (not possible)</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
    </tr>
  </tbody>
</table>

<p>The last case not possible as the hitting treatment of the first person will break the glass. Therefore, we can not say that the glass is broken whenever a person throw a ball. This example reveals that the verification of causality for multi-variates is hard and nontrivial.</p>

<h3 id="21--insights-on-neural-networks">2.1 üí° Insights on Neural Networks</h3>

<p>This examples show that counterfactual-based causality analysis and localized contribution of a variable may not truly reveals the causality between nodes in neural networks. To do this, we may need genuinely independent nodes in a layer so that the interaction between nodes does not affect the interpretation of causality (or at least we may need metrics to evaluate the relationship between nodes in the contribution of causality.)</p>

<p>The multiple nodes or variables are inherited properties of causal modeling. That is, the earth has many components interacting with each other. One good approach would be clarifying the nodes in a neural network so that the independent assumption holds.</p>


      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

<!--
    </div>
 -->
      <hr>
<div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script>
      let giscusTheme = localStorage.getItem("theme");
      let giscusAttributes = {
          "src": "https://giscus.app/client.js",
          "data-repo": "fxnnxc/fxnnxc",
          "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMjQ2NjUxMTU=",
          "data-category": "Q&A",
          "data-category-id": "DIC_kwDOE1n_G84CYOk_",
          "data-mapping": "title",
          "data-strict": "0",
          "data-reactions-enabled": "1",
          "data-emit-metadata": "0",
          "data-input-position": "top",
          "data-theme": giscusTheme,
          "data-lang": "en",
          "crossorigin": "anonymous",
          "async": "",
      };
  
  
      let giscusScript = document.createElement("script");
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById("giscus_thread").appendChild(giscusScript);
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by giscus.</a>
</noscript>
  </div>
<!-- Footer -->    <footer class="sticky-bottom mt-5" style="border: none;border-top:0px">
      <div class="container" style="text-align: center; ">
        ¬© Copyright 2024 Bumjini  . Powered by Jekyll with al-folio theme. Hosted by GitHub Pages.

      </div>
    </footer>
    
    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": 0 });
    $("progress-container").css({ "padding-top": 0 });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>
  </div></body>
  
  <d-bibliography src="/assets/bibliography/all.bib">
  </d-bibliography>
  <script src="/assets/js/distillpub/overrides.js"></script>

  <center>
    <a  href="">
    <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </a>
  </center>
  <hr> 

  </html>
