<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
    
<head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bumjini | Non-negative Matrix Factorization (NMF)</title>
    <meta name="author" content="Bumjini  " />
    <meta name="description" content="This is a gentle introduction of NMF. " />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü™¥</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://fxnnxc.github.io/side_articles/nmf/">
    
    <!-- Dark Mode -->
    

  <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams',
        inlineMath: [['$','$'], ['\\(','\\)']]
      },
      chtml: {
          scale: 1.0,
          minScale: .6,  
          mtextFontInherit: true,
          mtextInheritFont: true,
          merrorInheritFont: true,
        },
        svg: {
          scale: 1.2
        }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  <!-- Distill js -->
  <script src="/assets/js/distillpub/template.v2.js"></script>
  <script src="/assets/js/distillpub/transforms.v2.js"></script>
  <script src="/assets/js/distillpub/overrides.js"></script>
  <!-- Page/Post style -->
  
</head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Non-negative Matrix Factorization (NMF)",
      "description": "This is a gentle introduction of NMF. ",
      "published": "July 15, 2023",
      "authors": [
        {
          "author": "Bumjin Park",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body style="padding-top:0px" class="sticky-bottom-footer"> 
    
    <!-- Header --><header>
      
      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm sticky-top">
        <div class="container">
          <img>
          <!-- <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;"> -->
          
          <a class="navbar-brand title font-weight-lighter" href="https://fxnnxc.github.io/" style="margin-left:20px ;">
              <!--Bumjini-->
           <span class="font-weight-bold" style="font-size:larger;font-family:Times New Roman;">Bumjini    </span>
        </a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <!-- <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/">  About Me</a>
              </li> -->
              
              <!-- Blog -->
              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_papers/"> Papers</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_articles/"> Articles</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_projects/"> Projects</a>
              </li>

              <!-- Other pages -->
              <li style="font-size: 17px" class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Others</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/side_papers/">üóÇÔ∏è side-paper</a>
                  <a class="dropdown-item" href="/side_articles/">ü•ï side-articles</a>
                  <a class="dropdown-item" href="/book/">üìö book (korean)</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1 style="font-size: 32px;">Non-negative Matrix Factorization (NMF)</h1>
        <p>This is a gentle introduction of NMF. </p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        <d-contents>
          <nav class="l-text figcaption" style="line-height: 15px;">
          <h3>Contents</h3>
            <div style="margin:0.0em; margin-bottom: 10px;margin-top: 10px;"><a style="margin:0.0em;" href="#introduction">Introduction</a></div>
            
          </nav>
        </d-contents>

        <h1 id="introduction">Introduction</h1>
<p>Non-Negative matrix Factorization (NMF) is a kind of MF whose matrix is non-negative entries. NMF has been  widely used in the field of recommendation systems where users generate a massive number of information in the system and administrators want to find the important components. Consider the following example to understand the underlying assumptions of NMF.</p>

<p>There are two items whose representations are $[1,0,0]$ and $[1,1,0]$.<br>
<code class="language-plaintext highlighter-rouge">User 1</code> may select both items once, <code class="language-plaintext highlighter-rouge">User 2</code> may select only the second item once, and <code class="language-plaintext highlighter-rouge">User 3</code> may select the first item three times. As a result, we have the following representations for users.</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">User 1</code> Representation : $[2,1,0] = [1,0,0] + [1,1,0]$</li>
  <li>
<code class="language-plaintext highlighter-rouge">User 2</code> Representation : $[1,1,0] = 0\cdot [1,0,0] + [1,1,0]$</li>
  <li>
<code class="language-plaintext highlighter-rouge">User 3</code> Representation : $[3,0,0] = 3\cdot[1,0,0] + 0 \cdot [1,1,0]$</li>
</ul>

<p>When we stack the representations in rows, we observe the following form of a matrix</p>

\[M=
\begin{bmatrix}
  2 &amp; 1 &amp; 0 \\
  1 &amp; 1 &amp; 0 \\
  3 &amp; 0 &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots  
\end{bmatrix}
=
\begin{bmatrix}
  - \text{user } 1 - \\
  - \text{user } 2 - \\
  - \text{user } 3 - \\
  \vdots 
\end{bmatrix}\]

<p>Now, our problem is the reverse problem of finding items by decomposing the matrix. In detail, we find <strong>the underlying components</strong> (items) and <strong>weights which represent how the users select the components</strong>.</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">User 1</code> : \(w_{11} * \mathbf{c}_1 + w_{12} * \mathbf{c}_2 + \cdots\)</li>
  <li>
<code class="language-plaintext highlighter-rouge">User 2</code> : \(w_{21} * \mathbf{c}_1 + w_{22} * \mathbf{c}_2 + \cdots\)</li>
  <li>
<code class="language-plaintext highlighter-rouge">User 3</code> : \(w_{31} * \mathbf{c}_1 + w_{32} * \mathbf{c}_2 + \cdots\)</li>
</ul>

<blockquote>
  <p>Mathematically, When we have a matrix of size <code class="language-plaintext highlighter-rouge">n</code> $\times$ <code class="language-plaintext highlighter-rouge">d</code> where <code class="language-plaintext highlighter-rouge">d</code> is the dimension of items and $n$ is the number of users, we may want to discover the underlying fixed number <code class="language-plaintext highlighter-rouge">k</code> of components.</p>
</blockquote>

<p>We can also stack $w$ and $c$ to represent the overall factorization.</p>

\[M
=
\begin{bmatrix}
  2 &amp; 1 &amp; 0 \\
  1 &amp; 1 &amp; 0 \\
  3 &amp; 0 &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots  
\end{bmatrix}
=
\begin{bmatrix}
  - \text{user } 1 - \\
  - \text{user } 2 - \\
  - \text{user } 3 - \\
  \vdots 
\end{bmatrix}_{n\times d}
= 
\begin{bmatrix}
  - \mathbf{w}_1 - \\
  - \mathbf{w}_2 - \\
  - \mathbf{w}_3 - \\
  \vdots 
\end{bmatrix}_{n\times k}
\cdot 
\begin{bmatrix}
  - \mathbf{c}_1 - \\
  - \mathbf{c}_2 - \\
  - \mathbf{c}_3 - \\
  \vdots 
\end{bmatrix}_{k\times d}
=
W \cdot H\]

<h3 id="note1">Note1</h3>

<p>The <code class="language-plaintext highlighter-rouge">User 1</code> representation is the linear combination of component representations with weights. The symbol $\textcolor{blue}{k}$ represents number of elements linear combined.</p>

\[\begin{bmatrix}
  \textcolor{blue}{- \text{user } 1 -} \\
  - \text{user } 2 - \\
  - \text{user } 3 - \\
  \vdots 
\end{bmatrix}_{n\times d}
= 
\begin{bmatrix}
  \textcolor{blue}{- \mathbf{w}_1 -} \\
  - \mathbf{w}_2 - \\
  - \mathbf{w}_3 - \\
  \vdots 
\end{bmatrix}_{n\times \textcolor{blue}{k}}
\cdot 
\textcolor{blue}{\begin{bmatrix}
  - \mathbf{c}_1 - \\
  - \mathbf{c}_2 - \\
  - \mathbf{c}_3 - \\
  \vdots 
\end{bmatrix}}_{\textcolor{blue}{k}\times d}\]

<h3 id="note-2">Note 2</h3>
<p>There are many solutions to decompose the matrix into two factors $W$ and $H$. That is, the reverse problem does not guarantee the uniqueness of components and there are several ways we can decompose the matrix into weight matrix and component matrix. <d-footnote> Even though we build the matrix from user selections of items, there is no relationship between the items and the found components from the matrix factorization </d-footnote></p>

<h1 id="non-negative-matrix-factorization-nmf">Non-Negative Matrix Factorization (NMF)</h1>
<p>Let $M \in \mathbb{R}^{n\times d }$  be a non-negative matrix and $k$ is the number of components that we obtain by factorizing the matrix $M$. The factorization results in two matrices, weights $W \in \mathbb{R}^{n\times k }$ and components $H \in \mathbb{R}^{k\times d }$.</p>

\[M = W \cdot H\]

<p>According to Sklearn [<a href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html" target="_blank" rel="noopener noreferrer">link</a>], the objective is not only recovering the matrix with $W$ and $H$, but also regularizing two matrices.</p>

\[\begin{aligned}
L(W,H) &amp;= 0.5  \Vert X -HW \Vert_{loss}^{2} \\
      &amp;+ (L_1 \text{ regularization on vectors of } W) \\
      &amp;+ (L_1 \text{ regularization on vectors of } H) \\
      &amp;+ (\text{regularization on Frobenius norm of } W) \\
      &amp;+ (\text{regularization on Frobenius norm of } H)   
\end{aligned}\]

<h1 id="nmf-toy-example">NMF Toy Example</h1>

<p>Let‚Äôs consider a simple toy data for NMF. 
We have three four items: <code class="language-plaintext highlighter-rouge">pizza</code>, <code class="language-plaintext highlighter-rouge">chicken</code>, <code class="language-plaintext highlighter-rouge">burger</code>, and <code class="language-plaintext highlighter-rouge">fries</code> with the assumption that <code class="language-plaintext highlighter-rouge">fries</code> are always provided with a <code class="language-plaintext highlighter-rouge">burger</code>. Therefore, we have logically only three items even though the representation is four dimensional vector.</p>

<p><img src="/assets/side_articles/nmf/components.png" style="width:100%"></p>

<p>Note that it requires three items to represent <strong>the choice of a user</strong>, but four dimensions to represent <strong>physical items</strong>.</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">Pizza</code> : $[1,0,0,0]$</li>
  <li>
<code class="language-plaintext highlighter-rouge">Chicken</code> : $[0,1,0,0]$</li>
  <li>
<code class="language-plaintext highlighter-rouge">Burger+Fries</code> : $[0,0,1,1]$</li>
</ul>

<p>Now, there are multiple users who buy foods that they like.</p>

<center>
<img src="/assets/side_articles/nmf/selection.png" style="width:70%;">
</center>

<p>As the users can buy multiple foods, we can further make a toy matrix with weights.</p>

<ul>
  <li>
<span style="color:blue">blue color </span> : a person bought <strong>two</strong> packs</li>
  <li>
<span style="color:red">red color </span>  : a person bought <strong>three</strong> packs</li>
</ul>

\[M = 
\begin{bmatrix}
1 &amp; 1 &amp; \textcolor{blue}{2} &amp; \textcolor{blue}{2} \\
1 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 0 &amp; 1 &amp; 1 \\
0 &amp; 1 &amp; \textcolor{red}{3} &amp; \textcolor{red}{3} \\
1 &amp; 1 &amp; 0 &amp; 0 \\
\end{bmatrix}\]

<p>We can visualize the matrix with red colors.</p>
<center>
<img src="/assets/side_articles/nmf/matrix.png" style="width:50%">
</center>

<h3 id="nmf-result">NMF Result</h3>
<p>When we run the NMF with Sklearn, we have the following result.</p>

\[M = W (\text{weight}) \cdot H (\text{components})\]

<center>
<img src="/assets/side_articles/nmf/nmf2.png" style="width:100%">
</center>

<p>We can clearly see that components are one-hot vectors, but the magnitudes of components are not equal to 1. In addition, every component has different magnitude unlike the designed items of our toy food designs. In addition, when we run the algorithm with different seed we have different results.</p>

<h3 id="run-again">Run Again‚Ä¶</h3>
<center>
<img src="/assets/side_articles/nmf/nmf1.png" style="width:100%">
</center>

<p>It suggests that the iterative optimization in Sklearn does not provide a unique solution for NMF. 
However, we conjecture that correlated features are coupled when matrix is factorized (see <code class="language-plaintext highlighter-rouge">burger</code> and <code class="language-plaintext highlighter-rouge">fries</code> locations in columns 3 and 4 in component matrix). We can clearly see that two entries are in the same component.</p>

<h1 id="discussion">Discussion</h1>

<p>There are several questions when I learn NMF.</p>

<ol>
  <li>Are all elements of weights and components matrices zero? [ T / F ]</li>
  <li>In which matrix should be encourage sparsity [ W / H / Both ]</li>
  <li>Why should we decrease the Frobenius norm?</li>
  <li>With permutation and scaling, all NMF results are similar? That is, how many distinct NMF results with permutation and scale invariance.</li>
</ol>


      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

<!--<div id="disqus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script type="text/javascript">
        var disqus_shortname  = 'al-folio';
        var disqus_identifier = '/side_articles/nmf';
        var disqus_title      = "Non-negative Matrix Factorization (NMF)";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </div>
 -->
      <hr>
<div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script>
      let giscusTheme = localStorage.getItem("theme");
      let giscusAttributes = {
          "src": "https://giscus.app/client.js",
          "data-repo": "fxnnxc/fxnnxc",
          "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMjQ2NjUxMTU=",
          "data-category": "Q&A",
          "data-category-id": "DIC_kwDOE1n_G84CYOk_",
          "data-mapping": "title",
          "data-strict": "0",
          "data-reactions-enabled": "1",
          "data-emit-metadata": "0",
          "data-input-position": "top",
          "data-theme": giscusTheme,
          "data-lang": "en",
          "crossorigin": "anonymous",
          "async": "",
      };
  
  
      let giscusScript = document.createElement("script");
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById("giscus_thread").appendChild(giscusScript);
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by giscus.</a>
</noscript>
  </div>
<!-- Footer -->    <footer class="sticky-bottom mt-5" style="border: none;border-top:0px">
      <div class="container" style="text-align: center; ">
        ¬© Copyright 2024 Bumjini  . Powered by Jekyll with al-folio theme. Hosted by GitHub Pages.

      </div>
    </footer>
    
    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": 0 });
    $("progress-container").css({ "padding-top": 0 });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>
  </div></body>
  
  <d-bibliography src="/assets/bibliography/all.bib">
  </d-bibliography>
  <script src="/assets/js/distillpub/overrides.js"></script>

  <center>
    <a  href="">
    <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </a>
  </center>
  <hr> 

  </html>
