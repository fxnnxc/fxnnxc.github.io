<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
    
<head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bumjini | BERT Korean Symbol Representation Comparison</title>
    <meta name="author" content="Bumjini  " />
    <meta name="description" content="Multi Agent Environment in Terminal" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🪴</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://fxnnxc.github.io/main_projects/korean_bert_embedding/">
    
    <!-- Dark Mode -->
    

  <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams',
        inlineMath: [['$','$'], ['\\(','\\)']]
      },
      chtml: {
          scale: 1.0,
          minScale: .6,  
          mtextFontInherit: true,
          mtextInheritFont: true,
          merrorInheritFont: true,
        },
        svg: {
          scale: 1.2
        }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  <!-- Distill js -->
  <script src="/assets/js/distillpub/template.v2.js"></script>
  <script src="/assets/js/distillpub/transforms.v2.js"></script>
  <script src="/assets/js/distillpub/overrides.js"></script>
  <!-- Page/Post style -->
  
</head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "BERT Korean Symbol Representation Comparison",
      "description": "Multi Agent Environment in Terminal",
      "published": "September 6, 2023",
      "authors": [
        {
          "author": "Bumjin Park",
          "authorURL": "",
          "affiliations": [
            {
              "name": "KAIST",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body style="padding-top:0px" class="sticky-bottom-footer"> 
    
    <!-- Header --><header>
      
      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm sticky-top">
        <div class="container">
          <img>
          <!-- <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;"> -->
          
          <a class="navbar-brand title font-weight-lighter" href="https://fxnnxc.github.io/" style="margin-left:20px ;">
              <!--Bumjini-->
           <span class="font-weight-bold" style="font-size:larger;font-family:Times New Roman;">Bumjini    </span>
        </a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <!-- <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/">  About Me</a>
              </li> -->
              
              <!-- Blog -->
              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_papers/"> Papers</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_articles/"> Articles</a>
              </li>

              <li style="font-size: 17px" class="nav-item ">
                <a class="nav-link" href="/main_projects/"> Projects</a>
              </li>

              <!-- Other pages -->
              <li style="font-size: 17px" class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Others</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/side_papers/">🗂️ side-paper</a>
                  <a class="dropdown-item" href="/side_articles/">🥕 side-articles</a>
                  <a class="dropdown-item" href="/book/">📚 book (korean)</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1 style="font-size: 32px;">BERT Korean Symbol Representation Comparison</h1>
        <p>Multi Agent Environment in Terminal</p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        

        <blockquote>
  <p>This analysis is conducted to analyze Korean vocabulary in <strong>BERT embedding</strong>.</p>
</blockquote>

<h2 id="introduction">Introduction</h2>

<p>Language Modelings (LMs) has been widely applied to several NLP applications. 
When lots of NLP models are trained on several documents, the first step is to convert vocabulary into word embedding vectors. 
The vector representations in word embedding matrix, which are also called <code class="language-plaintext highlighter-rouge">"codes"</code> in <code class="language-plaintext highlighter-rouge">"codebook"</code>, are learned to minimize objectives such as 
casaul language modeling and masked language modeling.
When word embeddings are learned, we may expect similar representations if two words have commonality or relation.
To investigate such properties, we need to see the word representations in LMs. 
As such, this work conducts two visualizations</p>

<ol>
  <li>
    <p><strong>Pair-wise Distance</strong>  : which aims to compare representations of words</p>
  </li>
  <li>
    <p><strong>Direct Representation Visualization</strong>  : which aims to visualize vectors.</p>
  </li>
</ol>

<h2 id="visualization">Visualization</h2>

<p>We visualize two sets of words (actually tokens) in Korean. 
These tokens are sequentially located tokens in BERT vocabulary.</p>

<ul>
  <li>
<strong>Consonants</strong> : <code class="language-plaintext highlighter-rouge">[ㄱ ㄴ ㄷ ㄹ ㅁ ㅂ ㅅ ㅆ ㅇ ㅈ ㅊ ㅋ ㅌ ㅍ ㅎ ]</code>
</li>
  <li>
<strong>Vowels</strong> : <code class="language-plaintext highlighter-rouge">[ㅏ ㅐ ㅓ ㅔ ㅕ ㅗ ㅘ ㅛ ㅜ ㅝ ㅠ ㅡ ㅢ ]</code>
</li>
</ul>

<p><strong>Pairwise Disance</strong> computes cosine similarity between two token vectors which I guess have 768 dimension. The direct representation visualizations plots only 14 and 26 dimensions respectively for the first and last directions.  The reason is to see position invariant features. As positional encoding is applied, the early dimensions affected more by the position while the later dimensions have liite disturbance from positional encoding.</p>

<p>For example, if we have a word “Apple” and the word embedding for it, the positional dependent features are on the early parts and the semantic information of <code class="language-plaintext highlighter-rouge">"Apple"</code> is in the later location.</p>

<h4 id="consonants-자음">Consonants (자음)</h4>

<p><img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%211022&amp;authkey=%21ADpNs4WRFasrCSE&amp;width=1378&amp;height=396" style="width:140%;margin-left:0rem;border:1px;"></p>

<h4 id="vowels-모음">Vowels (모음)</h4>

<p><img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%211020&amp;authkey=%21AOkQbKD62FLw9wE&amp;width=1379&amp;height=396" style="width:140%;margin-left:0rem;border:1px;"></p>

<h4 id="both-together-자음--모음">Both Together (자음 + 모음)</h4>

<p><img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%211021&amp;authkey=%21AGySUqLKAnNrpkM&amp;width=1378&amp;height=396" style="width:140%;margin-left:0rem;border:1px;"></p>

<hr>

<h2 id="reproduce-the-result">Reproduce the Result</h2>

<d-code block="" language="python">

import torch 
import seaborn as sns 
import matplotlib.pyplot as plt 
from transformers import BertTokenizerFast
from transformers import BertForMaskedLM

size ="base" # large
model = BertForMaskedLM.from_pretrained(f"bert-{size}-uncased")
tokenizer = BertTokenizerFast.from_pretrained(f"bert-{size}-uncased")


# 👀 collect vocab symbols
consonants =  list(range(29991, 30006)) 
vowels     =  list(range(30006, 30019))
consonants_chars = []
vowels_chars = []
for c in consonants:
    for k, v in tokenizer.get_vocab().items():  
        if c == v:
            print(f"{c} : {k}")
            consonants_chars.append(k)
print("------")
for c in vowels:
    for k, v in tokenizer.get_vocab().items():  
        if c == v:
            print(f"{c} : {k}")
            vowels_chars.append(k)



# 👀 visualize
def plot_embeddings(indices, w, suptitle, ):
    fig, axes = plt.subplots(1,3,figsize=(14,4))
    fig.suptitle(suptitle ,fontproperties=fontprop)
    v = w[torch.tensor(indices),:]
    pdist = torch.nn.PairwiseDistance(p=2, keepdim=True)
    output = torch.cdist(v, v, p=2)
    
    sns.heatmap(output, ax=axes[0], cmap='plasma')
    axes[0].set_title("Pairwise Distance")
    axes[0].set_xlabel("token")
    axes[0].set_ylabel("token")

    
    # 👀 position variant locations and invariant locations
    pos = v[:, :len(indices)]
    sns.heatmap(pos, cmap="Reds", ax=axes[1])
    axes[1].set_title("First 12 dimensions")
    axes[1].set_xlabel("dim")
    axes[1].set_ylabel("token")

    inpos = v[:, -len(indices):]
    sns.heatmap(inpos, cmap="Blues", ax=axes[2])
    axes[2].set_title("Last 12 dimensions")
    axes[2].set_xlabel("dim")
    axes[2].set_ylabel("token")
    plt.tight_layout()
    
w = model.bert.embeddings.word_embeddings.weight.to("cpu").detach()
plot_embeddings(consonants, w, 'Consonants \n' + " ".join(consonants_chars) , )
plot_embeddings(vowels, w, 'Vowels \n ' + " ".join(vowels_chars))
plot_embeddings(consonants+vowels, w, 
                'Consonants + Vowels  \n' + " ".join(consonants_chars) + "\n" + " ".join(vowels_chars), )

</d-code>

      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

<!--<div id="disqus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script type="text/javascript">
        var disqus_shortname  = 'al-folio';
        var disqus_identifier = '/main_projects/korean_bert_embedding';
        var disqus_title      = "BERT Korean Symbol Representation Comparison";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </div>
 -->
      <hr>
<div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;">
    <script>
      let giscusTheme = localStorage.getItem("theme");
      let giscusAttributes = {
          "src": "https://giscus.app/client.js",
          "data-repo": "fxnnxc/fxnnxc",
          "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMjQ2NjUxMTU=",
          "data-category": "Q&A",
          "data-category-id": "DIC_kwDOE1n_G84CYOk_",
          "data-mapping": "title",
          "data-strict": "0",
          "data-reactions-enabled": "1",
          "data-emit-metadata": "0",
          "data-input-position": "top",
          "data-theme": giscusTheme,
          "data-lang": "en",
          "crossorigin": "anonymous",
          "async": "",
      };
  
  
      let giscusScript = document.createElement("script");
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById("giscus_thread").appendChild(giscusScript);
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by giscus.</a>
</noscript>
  </div>
<!-- Footer -->    <footer class="sticky-bottom mt-5" style="border: none;border-top:0px">
      <div class="container" style="text-align: center; ">
        © Copyright 2024 Bumjini  . Powered by Jekyll with al-folio theme. Hosted by GitHub Pages.

      </div>
    </footer>
    
    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": 0 });
    $("progress-container").css({ "padding-top": 0 });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>
  </div></body>
  
  <d-bibliography src="/assets/bibliography/all.bib">
  </d-bibliography>
  <script src="/assets/js/distillpub/overrides.js"></script>

  <center>
    <a  href="">
    <img src="/assets/common/KAIST-hi.gif" width="40px" style="margin-right:0px; padding-bottom: 3px;">
    </a>
  </center>
  <hr> 

  </html>
